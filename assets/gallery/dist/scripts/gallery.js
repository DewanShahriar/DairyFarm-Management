!function(t){t.fn.vitGallery=function(e){function n(e){Q=G.find("."+F.controlsClass),w=G.find(".gallery__block"),W=t(".prev"),x=t(".next"),I=t(t(".gallery__thumbnail").length?".gallery__thumbnail":".gallery__controls__item"),q=t(".gallery__inner"),S=q.find(".gallery__img-block.current"),M=L.find(".gallery__img-block__description"),T=S.index()}function i(){S=q.find(".gallery__img-block.current"),T=S.index(),M=L.find(".gallery__img-block__description"),X=t("."+K).find(".current"),"thumbnails"==F.controls&&(j=parseInt(B.css("left")))}function a(){L.each(function(){t(this).find("span").addClass("gallery__img-block__description"),t(this).find("img").addClass("gallery__img-block__img")}),n("addClasses")}function l(){L.wrapAll('<div class="gallery__block"><div class="'+z+'"></div></div>'),n("addWrapper")}function r(){var e=0;return F.imgPadding&&0!=F.imgPadding&&(e=(L.length-1)*F.imgPadding),L.each(function(){e+=t(this).outerWidth()}),n("getFullWidth"),e}function s(){var e=t("."+z);e.css("width",r()),n("setInnerWidth")}function o(){L.css("width",G.width()),n("setImgBlockWidth")}function c(){L.each(function(){var e=t(this).find(".gallery__img-block__img");t(this).addClass("load"),e.bindImageLoad(function(){var e=t(this);setTimeout(function(){e.parent().removeClass("load"),e=null},100)})}),n("setGalleryHeight")}function d(){if(F.controls){Q=G.find("."+F.controlsClass);for(var e='<span class="prev"></span>',i='<span class="next"></span>',a='<li class="gallery__controls__item"></li>',l=0;L.length>l;l++)var r=Q.append(a);t(".gallery__controls__item").each(function(e){t(this).addClass("item_"+e)}),Q.append(r);var s=t(r).find("li").wrapAll('<ul class="gallery__controls__ul"></ul>');t(s).parent().before(e).after(i)}n("createControls")}function u(){var e,i='<span class="prev"></span>',a='<span class="next"></span>',l='<div class="gallery__controls__inner"></div>',r='<div class="gallery__controls__thumbnails-ul"></div>';if(F.controls){Q=G.find("."+F.controlsClass);var s=Q.append(r);s.find(".gallery__controls__thumbnails-ul").append(l),H=s.find(".gallery__controls__thumbnails-ul"),B=s.find(".gallery__controls__inner"),L.each(function(){var n=t(this).find("img"),i=n.attr("thumb-url");e=document.createElement("img"),e.src=i,t(e).width(F.thumnailWidth).height(F.thumnaiHeight).addClass(J).css("margin-right",F.thumbnailMargin).attr("data-index",t(this).index()),B.append(t(e))}),B.css({width:(t(e).outerWidth()+F.thumbnailMargin)*t("."+J).length,left:0}),H.before(i).after(a),n("createThumbnails")}}function f(){var e=H.outerWidth(),n=t(".gallery__thumbnail"),i=n.outerWidth(),a=Math.round(e/i)/2;a=Math.round(a),P=n.eq(a-1),P.addClass("center")}function h(){w.after('<div class="'+E+'"></div>'),M.each(function(){t("."+E).append(t(this))}),M.eq(T).addClass("current"),n("createDescription")}function g(e,n){M=t("."+E).find(".gallery__img-block__description"),M.eq(e).removeClass("current"),M.eq(n).addClass("current")}function _(){L.each(function(e){0!=e&&t(this).css("display","inline-block")}),n("showImg")}function m(t){if(!S.is(":last-child")&&(q.animate({left:D-L.width()},F.animateSpeed),D-=L.width(),S.removeClass("current"),S.next().addClass("current"),I.eq(T).removeClass("current"),T++,I.eq(T).addClass("current"),F.autoplay&&(clearInterval(A),y()),g(T-1,T),t&&t(),i(),C(),"thumbnails"==F.controls)){H.offset().left+H.outerWidth(),I.last().offset().left+I.last().outerWidth()+F.thumbnailMargin}return T}function p(t){if(!S.is(":first-child")&&(q.animate({left:D+L.width()},F.animateSpeed),D+=L.width(),S.removeClass("current"),S.prev().addClass("current"),I.eq(T).removeClass("current"),T--,I.eq(T).addClass("current"),F.autoplay&&(clearInterval(A),y()),g(T+1,T),t&&t(),i(),C(),"thumbnails"==F.controls)){H.offset().left,I.first().offset().left}}function v(t){T<t?(q.animate({left:D-L.width()*(t-T)},F.animateSpeed),D-=L.width()*(t-T)):(q.animate({left:-(L.width()*(t+T)+D)},F.animateSpeed),D=-(L.width()*(t+T)+D)),g(q.find(".current").index(),t),q.find(".current").removeClass("current"),L.eq(t).addClass("current"),Q.find(".current").removeClass("current"),I.eq(t).addClass("current"),C(),i(),F.autoplay&&(clearInterval(A),y())}function y(){var t=L.length;console.log("autoplay"),A=setInterval(function(){(T+1)/t==1&&(console.log("the end"),clearInterval(A),setTimeout(function(){v(0)},F.autoplayDelay/2)),m()},F.autoplayDelay)}function b(){D=parseInt(q.css("left")),T=S.index(),W.on("click",function(){S=q.find(".gallery__img-block.current"),p()}),x.on("click",function(){S=q.find(".gallery__img-block.current"),m()}),I.on("click",function(){v(t(this).index())}),"thumbnails"==F.controls&&B.on("mousedown",function(e){var n,i=e.pageX,a=B.css("left");t(this).offset().left,t(this).offset().left+t(this).outerWidth();t(window).on("mousemove",function(t){var e=i-t.pageX,l=t.pageX;!function(){setTimeout(function(){n=t.pageX},50)}(),l>n&&B.css("left",parseInt(a)-e),l<n&&B.css("left",parseInt(a)-e),t.preventDefault()}).on("mouseup",function(e){e.preventDefault(),B.offset().left>=B.parent().offset().left&&(B.addClass("go-back").css("left",0),setTimeout(function(){B.removeClass("go-back")},300)),B.offset().left+B.outerWidth()<=B.parent().offset().left+B.parent().outerWidth()&&(B.addClass("go-back").css("left",B.parent().outerWidth()-B.outerWidth()),setTimeout(function(){B.removeClass("go-back")},300)),t(this).unbind("mousemove")}),e.preventDefault()}),t(window).on("resize",function(){F.autoplay&&clearInterval(A),c(),o(),s(),i(),q.css("left",-(T*S.width())),D=-(T*S.width()),F.autoplay&&y()})}function C(){var t=0;if(q.find(".current").length>0){if(t=q.find(".current").index(),"thumbnails"==F.controls){var e=I.eq(t).offset().left+(I.outerWidth()+F.thumbnailMargin)/2,a=P.offset().left+(I.outerWidth()+F.thumbnailMargin)/2;I.eq(t).index()>P.index()-1&&I.eq(t).index()<I.length-P.index()+1&&B.animate({left:-(e-a)},300)}I.eq(t).addClass("current"),q.css("left",-(t*L.width()))}else L.first().addClass("current"),I.first().addClass("current");return n("getCurrentSlide"),i(),t}function k(){a(),l(),_(),c(),o(),s(),"points"==F.controls?d():"thumbnails"==F.controls&&(u(),f()),C(),F.description&&h(),b(),F.autoplay&&y()}var w,W,x,I,q,M,D,S,T,H,P,X,B,j,A,F=t.extend({debag:!1,buttons:!0,galleryHeight:"auto",imgBlockClass:"gallery__img-block",controls:"thumbnails",controlsClass:"gallery__controls",thumnailWidth:90,thumnaiHeight:60,thumbnailMargin:15,animateSpeed:1e3,description:!0,imgPadding:15,autoplay:!1,autoplayDelay:3e3},e),G=t(this),L=G.find("."+F.imgBlockClass),Q=G.find("."+F.controlsClass),z="gallery__inner",E="gallery__description-block",J="gallery__thumbnail",K="gallery__controls";k()}}(jQuery),function(t){t.fn.bindImageLoad=function(e){function n(t){return!!t.complete&&("undefined"==typeof t.naturalWidth||0!==t.naturalWidth)}return this.each(function(){var i=t(this);i.is("img")&&t.isFunction(e)&&(i.one("load",e),n(this)&&i.trigger("load"))})}}(jQuery);